# Export Leads

You are exporting lead enrichment data to professional Excel and PDF files using the shared prospecting export script.

## Input

The user may provide:
- **Format**: `pdf`, `excel`, or `all` (default: `all`)
- **Data source**: Current session enrichment results (default), or a specific file path

If no enrichment data exists in the current session, ask: "I don't have enrichment data from this session. Would you like to provide a JSON file path, or run `/enrich-lead [company]` first?"

## Process

### Step 1: Gather Data

Collect the enrichment data from the current session. This should include:
- Company overview (from `/enrich-lead` or `/enrichment-report`)
- Contact records with validation status
- Engagement signals
- Analysis and next steps

### Step 2: Construct JSON Payload

Build the export payload matching the leads schema:

```json
{
  "type": "leads",
  "carrier": "[Company Name]",
  "region": "[Region]",
  "date": "YYYY-MM-DD",
  "report_type": "Leads",
  "search_summary": "Lead enrichment export for [Company Name]",
  "company_overview": {
    "name": "[company name]",
    "website": "[url]",
    "service_area": "[area]",
    "founded": "[year]",
    "employee_count": "[estimate]",
    "services": ["list"],
    "certifications": ["list"],
    "insurance_work": "[details]",
    "xactimate": "[yes/no]",
    "carrier_relationships": ["list"],
    "tpa_affiliations": ["list"]
  },
  "records": [
    {
      "name": "Contact Name",
      "title": "Title",
      "company": "[Company Name]",
      "email": "email@domain.com",
      "phone": "(xxx) xxx-xxxx",
      "validation_status": "valid",
      "confidence": 92,
      "priority": "high",
      "category": "decision_maker",
      "industry": "restoration",
      "notes": "Additional context"
    }
  ],
  "signals": [
    {"type": "news", "detail": "headline", "date": "YYYY-MM-DD", "source": "url"},
    {"type": "job_posting", "detail": "role", "date": "YYYY-MM-DD", "source": "url"}
  ],
  "analysis": "Analysis text from enrichment",
  "next_steps": ["Step 1", "Step 2"]
}
```

### Step 3: Write and Execute

```bash
cat > /tmp/lead_export.json << 'EXPORT_EOF'
{ ... json payload ... }
EXPORT_EOF

~/.claude/scripts/.venv/bin/python3 ~/.claude/scripts/prospecting_export.py \
  --input /tmp/lead_export.json

rm /tmp/lead_export.json
```

### Step 4: Report Results

The script outputs JSON with file paths:
```
Exported to:
- Excel: /mnt/c/Users/RonKlatt_3qsjg34/Desktop/Claude Code Plugin Output/{Company_Name}/{date}_{Company}_{Region}_Leads.xlsx
- PDF: /mnt/c/Users/RonKlatt_3qsjg34/Desktop/Claude Code Plugin Output/{Company_Name}/{date}_{Company}_{Region}_Leads.pdf
```

If the user only requested one format, note that both are generated by the script but highlight the requested one.

## Rules

- Always include all available data from the session â€” don't leave fields empty if data exists
- If company_overview data is available, include it (the export script will use it for the Company Overview sheet)
- If signals data is available, include it (the export script will use it for the Signals sheet)
- Date should be today's date in YYYY-MM-DD format
- Company name in the `carrier` field determines the output folder name
